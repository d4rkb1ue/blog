<!doctype html>
<html lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content='text/html; charset=utf-8' http-equiv='content-type' />

  <title>Algs4/Selection Sort, Insertion Sort, Shell Sort (Week 3 Part 1) - d4rkb1ue&#39;s Blog</title>
  <meta content='Algs4/Selection Sort, Insertion Sort, Shell Sort (Week 3 Part 1) - d4rkb1ue&#39;s Blog' property='title' />
  <meta content='Algs4/Selection Sort, Insertion Sort, Shell Sort (Week 3 Part 1) - d4rkb1ue&#39;s Blog' property='og:title' />


<meta property="og:description" content="Assertions MergeSort Botton-up MergeSort Sorting Complexity Java: Comparator interface Stability  Assertions // after sort assert isSorted(a, lo, hi); Can enable or disable at runtime
# enable assertions $ java -ea MyProgram # disable assertions (default) $ java -da MyProgram Best practices  Use assertions to check internal invariants assume assertions will be disabled in production code do not use for external argument checking  MergeSort Animation: Merge Sort" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://drkbl.com/posts/algorithms-part-1-note-5/" />


<meta property="article:published_time" content="2017-02-17T00:05:28&#43;00:00"/>

<meta property="article:modified_time" content="2017-02-17T00:05:28&#43;00:00"/>








<meta name="generator" content="Hugo 0.80.0" />

<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" rel="stylesheet">
<style type="text/css">/*https://coolors.co/afd5aa-f0f2ef-a69f98-3d3d3d-8c6057*/
:root {
  --main-color: #8C6056; 
  --secondary-color: #AFD5AA;
  --logo-text-color: #fff;
  --body-text-color: #3d3d3d;
  --heading-text-color: #383838;
  --background-color: #fff;
}</style>
<link href='/css/tachyons.min.css' rel="stylesheet">
<link href='/css/styles.css' rel="stylesheet">


<link rel="icon" 
 
  href='/favicon.ico'

type="image/x-icon"/>

<link href='/feed.xml' rel="alternate" type="application/atom+xml" title="d4rkb1ue&#39;s Blog" />

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-74825078-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</head>
<body class="global-font">
  <nav class=" justify-between border-box pa3 pl3-l pr2-l mt1 mt0-ns" id="navbar">
  <div class="flex">
    <a class="f4 fw6 ttu no-underline dim bg-main-color pv1 ph2 br2" id="site-title" href='/' title="Home">d4rkb1ue&#39;s Blog</a>
  </div>
  
</nav>
  
<main class="center mv4 content-width ph3">
  <div class="f3 fw6 heading-color heading-font post-title">Algs4/Selection Sort, Insertion Sort, Shell Sort (Week 3 Part 1)</div>
  <p class="silver f6 mt1 mb4 post-meta">
    <time>17 Feb 2017</time> 
     | 
    
    
    tags: [ <a href='/tags/algorithms' class="link silver">Algorithms</a> <a href='/tags/coursera' class="link silver">Coursera</a>  ]
    
  </p>
  <div class="lh-copy post-content"><ul>
<li>Assertions</li>
<li>MergeSort</li>
<li>Botton-up MergeSort</li>
<li>Sorting Complexity</li>
<li>Java: Comparator interface</li>
<li>Stability</li>
</ul>
<h1 id="assertions">Assertions</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// after sort
</span><span style="color:#75715e"></span><span style="color:#66d9ef">assert</span> isSorted<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> lo<span style="color:#f92672">,</span> hi<span style="color:#f92672">);</span>
</code></pre></div><p>Can enable or disable at runtime</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#960050;background-color:#1e0010">#</span> enable assertions
$ java <span style="color:#f92672">-</span>ea MyProgram

<span style="color:#960050;background-color:#1e0010">#</span> disable <span style="color:#a6e22e">assertions</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">default</span><span style="color:#f92672">)</span>
$ java <span style="color:#f92672">-</span>da MyProgram
</code></pre></div><h2 id="best-practices">Best practices</h2>
<ul>
<li>Use assertions to check internal invariants</li>
<li>assume assertions will be disabled in production code</li>
<li>do not use for external argument checking</li>
</ul>
<h1 id="mergesort">MergeSort</h1>
<p>Animation: <a href="http://www.sorting-algorithms.com/merge-sort">Merge Sort</a></p>
<h2 id="implement">Implement</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MergeSort</span><span style="color:#f92672">{</span>
    <span style="color:#75715e">/**
</span><span style="color:#75715e">    * Interface
</span><span style="color:#75715e">    **/</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mergeSort</span><span style="color:#f92672">(</span>Comparable<span style="color:#f92672">[]</span> a<span style="color:#f92672">){</span>
        Comparable<span style="color:#f92672">[]</span> aux <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Comparable<span style="color:#f92672">[</span>a<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">];</span>
        mergeSort<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> a<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
    <span style="color:#75715e">/**
</span><span style="color:#75715e">    * Recursion method
</span><span style="color:#75715e">    *
</span><span style="color:#75715e">    * Parameters:
</span><span style="color:#75715e">    * a: data
</span><span style="color:#75715e">    * aux: buffer
</span><span style="color:#75715e">    * lo: sort start at
</span><span style="color:#75715e">    * hi: sort end with
</span><span style="color:#75715e">    **/</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mergeSort</span><span style="color:#f92672">(</span>Comparable<span style="color:#f92672">[]</span> a<span style="color:#f92672">,</span> Comparable<span style="color:#f92672">[]</span> aux<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> lo<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> hi<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>lo <span style="color:#f92672">&gt;=</span> hi<span style="color:#f92672">)</span> <span style="color:#66d9ef">return</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> mid <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>lo <span style="color:#f92672">+</span> hi<span style="color:#f92672">)</span> <span style="color:#f92672">/</span> 2<span style="color:#f92672">;</span>
        p<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;mergeSort: [&#34;</span> <span style="color:#f92672">+</span> lo <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, &#34;</span> <span style="color:#f92672">+</span> mid <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;]&#34;</span><span style="color:#f92672">);</span>
        mergeSort<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> lo<span style="color:#f92672">,</span> mid<span style="color:#f92672">);</span>
        p<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;mergeSort: [&#34;</span> <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>mid<span style="color:#f92672">+</span>1<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, &#34;</span> <span style="color:#f92672">+</span> hi <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;]&#34;</span><span style="color:#f92672">);</span>
        mergeSort<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> mid <span style="color:#f92672">+</span> 1<span style="color:#f92672">,</span> hi<span style="color:#f92672">);</span>
        p<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;merge: [&#34;</span> <span style="color:#f92672">+</span> lo <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, &#34;</span> <span style="color:#f92672">+</span> mid <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;] + [&#34;</span> <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>mid<span style="color:#f92672">+</span>1<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, &#34;</span> <span style="color:#f92672">+</span> hi <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;] -&gt; [&#34;</span> <span style="color:#f92672">+</span> lo <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, &#34;</span> <span style="color:#f92672">+</span> hi <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;]&#34;</span><span style="color:#f92672">);</span>
        merge<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> lo<span style="color:#f92672">,</span> mid<span style="color:#f92672">,</span> hi<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
    <span style="color:#75715e">/**
</span><span style="color:#75715e">    * Merge two sub-arrays into one: aux[lo, mid] + aux[mid + 1, hi] -&gt; arr[lo, hi]
</span><span style="color:#75715e">    * 
</span><span style="color:#75715e">    * Parameters:
</span><span style="color:#75715e">    * a: target data
</span><span style="color:#75715e">    * aux: source data, buffer
</span><span style="color:#75715e">    * lo: source 1 start at
</span><span style="color:#75715e">    * mid: source 1 end with, source 2 start at mid+1
</span><span style="color:#75715e">    * hi: source 2 end with
</span><span style="color:#75715e">    **/</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">merge</span><span style="color:#f92672">(</span>Comparable<span style="color:#f92672">[]</span> a<span style="color:#f92672">,</span> Comparable<span style="color:#f92672">[]</span> aux<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> lo<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> mid<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> hi<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> lo<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;=</span> hi<span style="color:#f92672">;</span> i<span style="color:#f92672">++){</span>
            aux<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> a<span style="color:#f92672">[</span>i<span style="color:#f92672">];</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">// count: point to target array
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> lo<span style="color:#f92672">;</span>
        <span style="color:#75715e">// lm: point to arr[lo, mid]
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">int</span> lm <span style="color:#f92672">=</span> lo<span style="color:#f92672">;</span>
        <span style="color:#75715e">// mh: point to arr[mid+1, hi]
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">int</span> mh <span style="color:#f92672">=</span> mid <span style="color:#f92672">+</span> 1<span style="color:#f92672">;</span>

        <span style="color:#66d9ef">while</span><span style="color:#f92672">(</span>count <span style="color:#f92672">&lt;=</span> hi<span style="color:#f92672">){</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>lm <span style="color:#f92672">&gt;</span> mid<span style="color:#f92672">)</span>                       a<span style="color:#f92672">[</span>count<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> aux<span style="color:#f92672">[</span>mh<span style="color:#f92672">++];</span>
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>mh <span style="color:#f92672">&gt;</span> hi<span style="color:#f92672">)</span>                   a<span style="color:#f92672">[</span>count<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> aux<span style="color:#f92672">[</span>lm<span style="color:#f92672">++];</span>
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>less<span style="color:#f92672">(</span>aux<span style="color:#f92672">[</span>lm<span style="color:#f92672">],</span> aux<span style="color:#f92672">[</span>mh<span style="color:#f92672">]))</span>    a<span style="color:#f92672">[</span>count<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> aux<span style="color:#f92672">[</span>lm<span style="color:#f92672">++];</span>
            <span style="color:#66d9ef">else</span>                                a<span style="color:#f92672">[</span>count<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> aux<span style="color:#f92672">[</span>mh<span style="color:#f92672">++];</span>
            <span style="color:#75715e">// == else if (aux[lo] &gt; aux[mid + 1])
</span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">less</span><span style="color:#f92672">(</span>Comparable a<span style="color:#f92672">,</span> Comparable b<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">return</span> a<span style="color:#f92672">.</span><span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span>b<span style="color:#f92672">)</span> <span style="color:#f92672">&lt;</span> 0<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    <span style="color:#75715e">// unit test
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">){</span>
        <span style="color:#75715e">// int[] will cause error, since int is not Comparable. Auto-boxing do not cover this case
</span><span style="color:#75715e"></span>        Integer<span style="color:#f92672">[]</span> a <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>4<span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>52<span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>23<span style="color:#f92672">,</span>9<span style="color:#f92672">,</span>20<span style="color:#f92672">,</span>0<span style="color:#f92672">};</span>
        mergeSort<span style="color:#f92672">(</span>a<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">:</span> a<span style="color:#f92672">){</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span>i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, &#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">p</span><span style="color:#f92672">(</span>String s<span style="color:#f92672">){</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>s<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="cost">Cost</h2>
<p>Time</p>
<blockquote>
<p>Mergesort uses at most N lg N compares and 6 N lg N array accesses to sort any array of size N</p>
</blockquote>
<p>Space</p>
<blockquote>
<p>Mergesort uses extra space proportional to N.</p>
</blockquote>
<p><em>A sorting algorithm is in-place if it uses ≤ c log N extra memory. Ex. Insertion sort, selection sort, shellsort.</em></p>
<h2 id="improvements">Improvements</h2>
<p>Use insertion sort for small subarrays.</p>
<ul>
<li>Mergesort has too much overhead for tiny subarrays.</li>
<li>Cutoff to insertion sort for ≈ 7 items.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">cutOffSort</span><span style="color:#f92672">(</span>Comparable<span style="color:#f92672">[]</span> a<span style="color:#f92672">,</span> Comparable<span style="color:#f92672">[]</span> aux<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> lo<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> hi<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">int</span> CUTOFF <span style="color:#f92672">=</span> 7<span style="color:#f92672">;</span> <span style="color:#75715e">// 7 is fine
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// length = hi - lo + 1
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>hi <span style="color:#f92672">-</span> lo <span style="color:#f92672">+</span> 1 <span style="color:#f92672">&lt;=</span> CUTOFF<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            Insertion<span style="color:#f92672">.</span><span style="color:#a6e22e">sort</span><span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> lo<span style="color:#f92672">,</span> hi<span style="color:#f92672">);</span>
            <span style="color:#66d9ef">return</span><span style="color:#f92672">;</span> 
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">int</span> mid <span style="color:#f92672">=</span> lo <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>hi <span style="color:#f92672">-</span> lo<span style="color:#f92672">)</span> <span style="color:#f92672">/</span> 2<span style="color:#f92672">;</span> 
        sort <span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> lo<span style="color:#f92672">,</span> mid<span style="color:#f92672">);</span>
        sort <span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> mid<span style="color:#f92672">+</span>1<span style="color:#f92672">,</span> hi<span style="color:#f92672">);</span> 
        merge<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> lo<span style="color:#f92672">,</span> mid<span style="color:#f92672">,</span> hi<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
</code></pre></div><p>will make it maybe 20% faster.</p>
<p>Stop if sorted: max item of first half is smaller than right half.</p>
<p><img src="/images/algorithem_coursera/mergesort_stop_when_sorted.png" alt="mergesort_stop_when_sorted.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mergeSort</span><span style="color:#f92672">(</span>Comparable<span style="color:#f92672">[]</span> a<span style="color:#f92672">,</span> Comparable<span style="color:#f92672">[]</span> aux<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> lo<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> hi<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>lo <span style="color:#f92672">&gt;=</span> hi<span style="color:#f92672">)</span> <span style="color:#66d9ef">return</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> mid <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>lo <span style="color:#f92672">+</span> hi<span style="color:#f92672">)</span> <span style="color:#f92672">/</span> 2<span style="color:#f92672">;</span>
        mergeSort<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> lo<span style="color:#f92672">,</span> mid<span style="color:#f92672">);</span>
        mergeSort<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> mid <span style="color:#f92672">+</span> 1<span style="color:#f92672">,</span> hi<span style="color:#f92672">);</span>
        <span style="color:#75715e">// max item of first half is smaller than right half, so it is already sorted
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>less<span style="color:#f92672">(</span>a<span style="color:#f92672">[</span>mid<span style="color:#f92672">],</span> a<span style="color:#f92672">[</span>mid <span style="color:#f92672">+</span> 1<span style="color:#f92672">]))</span> <span style="color:#66d9ef">return</span><span style="color:#f92672">;</span>
        merge<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> lo<span style="color:#f92672">,</span> mid<span style="color:#f92672">,</span> hi<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
</code></pre></div><p>Eliminate the copy to the auxiliary array.</p>
<p>// TODO: 不懂？</p>
<p><img src="/images/algorithem_coursera/mergesort_elimiate_copy.png" alt="mergesort_elimiate_copy.png"></p>
<h1 id="botton-up-mergesort">Botton-up MergeSort</h1>
<p>Remove recursive.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mergeSortWithoutRecursive</span><span style="color:#f92672">(</span>Comparable<span style="color:#f92672">[]</span> a<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">int</span> N <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span>
        Comparable<span style="color:#f92672">[]</span> aux <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Comparable<span style="color:#f92672">[</span>N<span style="color:#f92672">];</span>
        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> sz <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span> sz <span style="color:#f92672">&lt;</span> N<span style="color:#f92672">;</span> sz <span style="color:#f92672">*=</span> 2<span style="color:#f92672">){</span>
            <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> lo <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> lo <span style="color:#f92672">&lt;</span> N <span style="color:#f92672">-</span> sz<span style="color:#f92672">;</span> lo <span style="color:#f92672">+=</span> sz<span style="color:#f92672">*</span>2<span style="color:#f92672">)</span>
                merge<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> aux<span style="color:#f92672">,</span> lo<span style="color:#f92672">,</span> lo<span style="color:#f92672">+</span>sz<span style="color:#f92672">-</span>1<span style="color:#f92672">,</span> Math<span style="color:#f92672">.</span><span style="color:#a6e22e">min</span><span style="color:#f92672">(</span>lo<span style="color:#f92672">+</span>2<span style="color:#f92672">*</span>sz<span style="color:#f92672">-</span>1<span style="color:#f92672">,</span> N<span style="color:#f92672">-</span>1<span style="color:#f92672">));</span>
        <span style="color:#f92672">}</span><span style="color:#75715e">// end for size
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
</code></pre></div><p><img src="/images/algorithem_coursera/bottom_up_mergesort_trace.png" alt="bottom_up_mergesort_trace.png"></p>
<ul>
<li>It does not always divide by half. So a part might be small than other(s).</li>
<li>10% slower than recursive, top-down mergesort on typical systems</li>
<li>get log(2)(n) passes(遍历)</li>
</ul>
<h1 id="complexity">Complexity</h1>
<ul>
<li>
<p>Model of computation: Allowable operations</p>
</li>
<li>
<p>Cost model: Operation count(s)</p>
</li>
<li>
<p>Upper bound: Cost guarantee provided by some algorithm for X (current algorithms can achieve)</p>
</li>
<li>
<p>Lower bound: Proven limit on cost guarantee of all algorithms for X (future possible algorithms can maximumly achieve)</p>
</li>
<li>
<p>Optimal algorithm: Algorithm with best possible cost guarantee for X (this algorithm is the best)</p>
</li>
</ul>
<h2 id="sort-complexity">Sort Complexity</h2>
<ul>
<li>Model of computation: decision tree (can access information only through compares; example below)</li>
<li>Cost model: # compares.</li>
<li>Upper bound: ~ N lg N from mergesort</li>
<li>Lower bound: N lg N</li>
<li>Optimal algorithm: mergesort</li>
</ul>
<h3 id="decision-tree">Decision tree</h3>
<p><img src="/images/algorithem_coursera/sort_decision_tree.png" alt="sort_decision_tree.png"></p>
<ul>
<li>Height: Worst case: 3 compares. Aka, the height of decision tree.</li>
<li>Leaf: each possible ordering</li>
</ul>
<h2 id="lower-bound">Lower bound</h2>
<p>We can proof that any compare-based sort algorithm must use at least N lg N compares in the worst-case.</p>
<p>Pf.</p>
<p><img src="/images/algorithem_coursera/sort_decision_tree_leaves.png" alt="sort_decision_tree_leaves.png"></p>
<p>leaves  = N!
max hight = lg N! (log(2)(N!))
=&gt;
lg(N!) = N lg N (Stirling&rsquo;s formula)</p>
<h2 id="optimal-algorithm">Optimal algorithm</h2>
<p>Since mergesort has a cost of N lg N in the worst-case. So it’s the best algorithm.
But mergesort is not good at Space cost. It cost twice N.</p>
<p>In some particular cases, MergeSort may not be the best:</p>
<ul>
<li>Partially-ordered arrays. Depending on the initial order of the input, we may not need N lg N compares. Ex. insertion sort requires only N-1 compares if input array is sorted.</li>
</ul>
<h1 id="java-comparator-interface">Java: Comparator interface</h1>
<p>Usage:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sort</span><span style="color:#f92672">(</span>Object<span style="color:#f92672">[]</span> a<span style="color:#f92672">,</span> Comparator comparator<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">int</span> N <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> N<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span>
        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> i<span style="color:#f92672">;</span> j <span style="color:#f92672">&gt;</span> 0 <span style="color:#f92672">&amp;&amp;</span> less<span style="color:#f92672">(</span>comparator<span style="color:#f92672">,</span> a<span style="color:#f92672">[</span>j<span style="color:#f92672">],</span> a<span style="color:#f92672">[</span>j<span style="color:#f92672">-</span>1<span style="color:#f92672">]);</span> j<span style="color:#f92672">--)</span> 
            exchange<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> j<span style="color:#f92672">,</span> j<span style="color:#f92672">-</span>1<span style="color:#f92672">);</span> 
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">less</span><span style="color:#f92672">(</span>Comparator c<span style="color:#f92672">,</span> Object v<span style="color:#f92672">,</span> Object w<span style="color:#f92672">)</span> <span style="color:#f92672">{</span> <span style="color:#66d9ef">return</span> c<span style="color:#f92672">.</span><span style="color:#a6e22e">compare</span><span style="color:#f92672">(</span>v<span style="color:#f92672">,</span> w<span style="color:#f92672">)</span> <span style="color:#f92672">&lt;</span> 0<span style="color:#f92672">;</span> <span style="color:#f92672">}</span>

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">exchange</span><span style="color:#f92672">(</span>Object<span style="color:#f92672">[]</span> a<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> i<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> j<span style="color:#f92672">)</span> <span style="color:#f92672">{</span> Object swap <span style="color:#f92672">=</span> a<span style="color:#f92672">[</span>i<span style="color:#f92672">];</span> a<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> a<span style="color:#f92672">[</span>j<span style="color:#f92672">];</span> a<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> swap<span style="color:#f92672">;</span>
</code></pre></div><p>Implement:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Comparator<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> BY_NAME <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ByName<span style="color:#f92672">();</span> 
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Comparator<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> BY_SECTION <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BySection<span style="color:#f92672">();</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String name<span style="color:#f92672">;</span> 
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> section<span style="color:#f92672">;</span> 

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ByName</span> <span style="color:#66d9ef">implements</span> Comparator<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span><span style="color:#f92672">(</span>Student v<span style="color:#f92672">,</span> Student w<span style="color:#f92672">)</span> <span style="color:#f92672">{</span> 
            <span style="color:#66d9ef">return</span> v<span style="color:#f92672">.</span><span style="color:#a6e22e">name</span><span style="color:#f92672">.</span><span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span>w<span style="color:#f92672">.</span><span style="color:#a6e22e">name</span><span style="color:#f92672">);</span> <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
    <span style="color:#960050;background-color:#1e0010">…</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BySection</span> <span style="color:#66d9ef">implements</span> Comparator<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span><span style="color:#f92672">(</span>Student v<span style="color:#f92672">,</span> Student w<span style="color:#f92672">)</span> <span style="color:#f92672">{</span> 
            <span style="color:#66d9ef">return</span> v<span style="color:#f92672">.</span><span style="color:#a6e22e">section</span> <span style="color:#f92672">-</span> w<span style="color:#f92672">.</span><span style="color:#a6e22e">section</span><span style="color:#f92672">;</span> <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
</code></pre></div><h1 id="stability">Stability</h1>
<p>Ex. for unstable</p>
<p><img src="/images/algorithem_coursera/unstable_sort.png" alt="unstable_sort.png"></p>
<p>After sort, students in <code>section 3</code> no longer stay sorted by name.</p>
<h2 id="what-is-stable">What is Stable?</h2>
<ul>
<li>A stable sort preserves the relative order of items with equal keys</li>
<li>Never move equal items pass one another</li>
</ul>
<p>Stable sort:</p>
<ul>
<li>insertion sort</li>
<li>mergesort</li>
</ul>
<p>Unstable sort:</p>
<ul>
<li>selection sort</li>
<li>shellsort</li>
</ul>
<h2 id="why-is-selection-sort-not-stable">Why is Selection Sort not stable?</h2>
<p>A small example:</p>
<pre><code>Let b = B in

&lt; B &gt; , &lt; b &gt; , &lt; a &gt; , &lt; c &gt; (with a &lt; b &lt; c)

After one cycle the sequence is sorted but the order of B and b has changed:

&lt; a &gt; , &lt; b &gt; , &lt; B &gt; , &lt; c &gt;
</code></pre></div>
</main>
 






<div class="tl fixed list-pages lh-copy" id="contents-list"></div>



<div class="pagination tc tr-l db fixed-l bottom-2-l right-2-l mb3 mb0-l">
  
<a id="scroll-to-top" class="f6 o-0 link br2 ph2 pv1 mb1 bg-main-color pointer" onclick="topFunction()" style="color: #fff; visibility: hidden; display: none; transition: opacity .5s, visibility .5s;" title="back to top">back to top</a>
<br>
  <p class="mb0 mt2">
  <a href="https://drkbl.com/posts/algorithms-part-1-note-4/">prev post</a>
  <a href="https://drkbl.com/posts/sublime-select-tricks/">next post</a>
  </p>
</div>

  <footer class="content-width mt0 mt5-l mb4 f6 center ph3 gray tc tl-l">
  <hr class="dn db-l ml0-l gray w3"><br>
  Powered by <a href="https://gohugo.io/" target="_blank" class="link gray dim">Hugo</a>, based on the <a href="https://github.com/lingxz/er" target="_blank" class="link gray dim">Er</a> theme. <br>
  Contact me at 7874364@gmail.com
</footer>
  



<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<style>.is-active-link::before { background-color: var(--secondary-color); }</style>




<script type="text/javascript">
var prevScrollpos = window.pageYOffset;
window.onscroll = function() {
  var currentScrollPos = window.pageYOffset;

  
  if (document.getElementById("tag-cloud") !== null) { 
    if (prevScrollpos > currentScrollPos) { 
      document.getElementById("tag-cloud").style.visibility = "visible";
      document.getElementById("tag-cloud").style.opacity = "1";
    } else {
      document.getElementById("tag-cloud").style.visibility = "hidden";
      document.getElementById("tag-cloud").style.opacity = "0";
    }
  }
  

  
  if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
      document.getElementById("scroll-to-top").style.display = "inline";
      document.getElementById("scroll-to-top").style.visibility = "visible";
      document.getElementById("scroll-to-top").style.opacity = "1";
  } else {
      document.getElementById("scroll-to-top").style.visibility = "hidden";
      document.getElementById("scroll-to-top").style.opacity = "0";
  }
  
  prevScrollpos = currentScrollPos;
}


function topFunction() {
  document.body.scrollTop = 0; 
  document.documentElement.scrollTop = 0; 
}






if (document.getElementById("contents-list") !== null && document.getElementsByClassName("post-content").length !== 0) { 
  tocbot.init({
    
    tocSelector: '#contents-list',
    
    contentSelector: '.post-content',
    
    headingSelector: 'h1, h2, h3',
  });
}


</script>




</body>
</html>